# üìå COIN: A Controllable Cytology Image Generation Foundation Model

<p align="center"> <img src="https://img.shields.io/badge/Cytology-Foundation--Model-green" /> <img src="https://img.shields.io/badge/Generative-AI-FF69B4" /> 
  
### üåü Project Highlights

COIN is a foundation model for controllable cytology image generation, trained on over 112,000 cytology image-report pairs across 16 anatomical sites.
It enables privacy-preserving, realistic synthetic cytology image generation driven by diagnostic reports.

The pretrained COIN model weights are available on [Hugging Face](https://huggingface.co/LexieK/COIN).  
You can request access and download the weights directly from the link above.

üéâ We are also delighted to share that the COIN manuscript has been accepted by Clinical Cancer Research.

### üìù Abstract
Purpose: Cytology is a cornerstone of pathologic diagnosis. However, the use of artificial intelligence (AI) models for cytology-based diagnostics remains constrained by limited data availability and stringent privacy regulations. This study aims to develop COIN, a controllable cytology image generation foundation model, to address these challenges by synthesizing high-quality cytology images to enhance AI diagnostics and support clinical applications. 
Experimental Design: The COIN model was trained on a large-scale dataset of 112,226 cytology image‚Äìreport pairs from 16 anatomic sites. Using diagnostic textual reports, it generates 
high-fidelity cytology images with morphologically and semantically coherent features. Expert cytologists evaluated the generated images for anatomic and diagnostic authenticity. The 
model‚Äôs utility was assessed through data augmentation experiments, AI model training under data-scarce conditions, and content-based image retrieval applications. 
Results: Expert evaluations confirmed the high anatomic and diagnostic fidelity of the images generated by COIN. When used for data augmentation, COIN significantly improved the performance of diagnostic AI models across various tasks. Under data-scarce conditions, models trained exclusively on COIN-generated images demonstrated effective generalization to real-world datasets. Furthermore, COIN supported content-based image retrieval, offering a novel tool for case referencing and clinical decision support. 
Conclusions: COIN represents a robust and privacy-preserving framework for scalable cytology data generation. Its ability to synthesize realistic images and enhance AI diagnostics highlights its broad applicability in computational pathology, providing a valuable tool to accelerate the development and implementation of AI-based diagnostic solutions.


### üõ†Ô∏è Getting started

Clone this repo:

```
https://github.com/LexieK7/COIN.git
cd COIN
conda env create -f requirements.yml
```



### üìÇ Usage
### 1Ô∏è‚É£ Generate Cytology Images from texts

```
from diffusers import DiffusionPipeline
import torch
import os

sdxl_base_model = "./sd_xl_1-0"   
lora_model_path = "MODEL PATH"  
save_folder = "./generated_images"
prompt = "No intraepithelial lesion or malignancy (NILM)."
guidance_scale = 7.5
num_inference_steps = 50

pipe = DiffusionPipeline.from_pretrained(sdxl_base_model)
pipe.to("cuda")
pipe.load_lora_weights(lora_model_path)

save_path = os.path.join(save_folder, "example.jpg")
image = pipe(prompt, num_inference_steps=num_inference_steps, guidance_scale=guidance_scale).images[0]
image.save(save_path)

```



### üìÑ Citation

If you find this work useful, please cite us:

```
@article{zheng2026generative,
  title={A Generative Foundation Model for Scalable Cytology Image Synthesis in AI-Powered Diagnostics},
  author={Zheng, Ke and Zheng, Xueyi and Wang, Jue and Zhang, Xinke and Chen, Shiping and Chen, Qunxi and Fu, Sha and Xie, Dan and Wang, Ruixuan and Lai, Junpeng and others},
  journal={Clinical Cancer Research},
  pages={OF1--OF12},
  year={2026},
  publisher={American Association for Cancer Research}
}
```
